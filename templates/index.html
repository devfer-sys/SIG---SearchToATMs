<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Buscador de Cajeros ‚Äì UPEA</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/style.css">
</head>
<body class="fondo">

<div class="container py-5">
    <div class="card shadow-lg p-4 borde-upea-oscuro">
        <div class="d-flex align-items-center justify-content-between mb-4">
            <img src="/static/upea.png" alt="Logo Izquierdo" width="80" height="80">
            <h2 class="titulo-upea mb-0 text-center flex-grow-1">Buscador de Cajeros</h2>
            <img src="/static/escudo.png" alt="Logo Derecho" width="80" height="80">
        </div>

        <p class="text-center">
            Activa tu ubicaci√≥n para encontrar los cajeros m√°s cercanos en <b>La Paz</b> y <b>El Alto</b>.
        </p>

        <div class="mb-3">
            <label class="form-label fw-bold">Seleccionar Banco</label>
            <select id="banco" class="form-select">
                <option value="todos">Todos</option>
                <option value="BCP">BCP</option>
                <option value="BNB">BNB</option>
                <option value="Union">Banco Uni√≥n</option>
                <option value="Econ√≥mico">Banco Econ√≥mico</option>
                <option value="FIE">Banco FIE</option>
            </select>
        </div>

        <button class="btn btn-upea w-100 mb-2" onclick="enviar()">Buscar Cajeros Cercanos</button>

        <div id="resultado" class="mt-4"></div>
    </div>

    <!-- Secci√≥n de Informaci√≥n -->
    <div class="card shadow-lg p-4 borde-upea-oscuro mt-5">

        <h4 class="text-center mb-3">üéØ ¬øQu√© hace esta aplicaci√≥n?</h4>
        <ul>
            <li>‚úî Obtiene tu ubicaci√≥n mediante geolocalizaci√≥n.</li>
            <li>‚úî Identifica los cajeros m√°s cercanos de distintos bancos.</li>
            <li>‚úî Aplica c√°lculo geoespacial con la f√≥rmula Haversine.</li>
            <li>‚úî Utiliza SQLite como base de datos local.</li>
            <li>‚úî Permite visualizar las rutas en un mapa interactivo.</li>
        </ul>

        <p>
            Esta herramienta es un ejemplo pr√°ctico de <b>Sistemas de Informaci√≥n Geogr√°fica (SIG)</b> aplicada a la vida cotidiana. Su objetivo es demostrar c√≥mo los datos espaciales pueden integrarse con servicios financieros para mejorar la accesibilidad, planificaci√≥n y toma de decisiones en entornos urbanos.
        </p>

        <!-- NUEVA SECCI√ìN 1 -->
        <h4 class="mt-4 mb-3 text-center">üìå ¬øC√≥mo funciona el sistema?</h4>
        <ol>
            <li><b>1. Captura tu posici√≥n GPS</b> mediante el navegador.</li>
            <li><b>2. Filtra</b> los cajeros por banco o muestra todos.</li>
            <li><b>3. Calcula</b> la distancia entre tu ubicaci√≥n y cada cajero registrado.</li>
            <li><b>4. Ordena</b> los resultados del m√°s cercano al m√°s lejano.</li>
            <li><b>5. Muestra</b> los cajeros con opci√≥n para verlos en un mapa interactivo.</li>
        </ol>

        <!-- NUEVA SECCI√ìN 2 --> 
        <h4 class="mt-4 mb-3 text-center">üåç Relevancia en Sistemas de Informaci√≥n Geogr√°fica (SIG)</h4>
        <p>
            Este proyecto pertenece a la materia de <b>SIG ‚Äì 7mo semestre, Gesti√≥n II/2025</b> en la <b>UPEA</b>, y demuestra competencias ligadas al an√°lisis espacial y la representaci√≥n cartogr√°fica digital. Entre los conceptos trabajados destacan:
        </p>

        <ul>
            <li>üî∏ Geolocalizaci√≥n en aplicaciones web.</li>
            <li>üî∏ An√°lisis espacial b√°sico (distancias geod√©sicas).</li>
            <li>üî∏ Uso de coordenadas geogr√°ficas y proyecciones.</li>
            <li>üî∏ Integraci√≥n de mapas digitales mediante Leaflet.</li>
            <li>üî∏ Gesti√≥n y almacenamiento de datos espaciales en SQLite.</li>
        </ul>

        <!-- NUEVA SECCI√ìN 3 -->
        <h4 class="mt-4 mb-3 text-center">üèô Aplicaci√≥n en la gesti√≥n urbana y territorial</h4>
        <p>
            Los SIG no solo sirven para cartograf√≠a: permiten organizar y analizar informaci√≥n sobre la ciudad. Este sistema puede aplicarse para:
        </p>
        <ul>
            <li>‚úî Estudios de accesibilidad a servicios financieros.</li>
            <li>‚úî Planificaci√≥n urbana en zonas con alta demanda de cajeros.</li>
            <li>‚úî Identificaci√≥n de √°reas sin cobertura bancaria.</li>
            <li>‚úî Evaluaci√≥n del comportamiento geogr√°fico de los usuarios.</li>
            <li>‚úî Optimizaci√≥n de rutas y movilidad en √°reas congestionadas.</li>
        </ul>

        <!-- NUEVA SECCI√ìN 4 -->
        <h4 class="mt-4 mb-3 text-center">üéì Objetivos Acad√©micos</h4>
        <p>Este proyecto busca que el estudiante:</p>
        <ul>
            <li>‚úî Aplique conceptos de SIG en un sistema funcional.</li>
            <li>‚úî Comprenda el uso de datos espaciales y su an√°lisis.</li>
            <li>‚úî Dise√±e interfaces que integren geolocalizaci√≥n real.</li>
            <li>‚úî Utilice herramientas modernas como Leaflet y SQLite.</li>
            <li>‚úî Combine teor√≠a y pr√°ctica en un proyecto √∫til para la comunidad.</li>
        </ul>

    </div>

</div>

<!-- Footer -->
<footer class="footer-fijo bg-upea-oscuro text-white text-center py-3">
    <div class="container">
        <p class="mb-1"><b>II/2025 ‚Äì SIG ‚Äì FFFG ‚Äì UPEA</b></p>
        <p class="mb-1">Sistemas de Informaci√≥n Geogr√°fica ‚Äì 7mo Semestre</p>
        <p class="mb-0">Ingenier√≠a de Sistemas</p>
    </div>
</footer>



<script>
let modoOscuro = true;

function enviar() {
    if (!navigator.geolocation) {
        alert("Tu navegador no soporta geolocalizaci√≥n.");
        return;
    }

    navigator.geolocation.getCurrentPosition(pos => {
        const lat = pos.coords.latitude;
        const lon = pos.coords.longitude;
        const banco = document.getElementById("banco").value;

        fetch("/buscar", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({lat, lon, banco})
        })
        .then(res => res.json())
        .then(lista => {
            if(lista.length === 0) {
                document.getElementById("resultado").innerHTML = "<p>No se encontraron cajeros.</p>";
                return;
            }

            let html = `<h5 class="mt-3">Resultados:</h5>`;
            lista.slice(0,10).forEach(a => {
                html += `
                <div class="alert alert-secondary shadow-sm">
                    <b>${a.banco}</b><br>
                    Distancia: ${a.distancia} km<br>
                    <a href="/mapa?lat=${lat}&lon=${lon}&banco=${banco}&modo=${modoOscuro ? 'oscuro' : 'claro'}" 
                       class="btn btn-sm btn-upea mt-2">Ver en mapa</a>
                </div>`;
            });
            document.getElementById("resultado").innerHTML = html;
        });
    }, err => {
        alert("No se pudo obtener la ubicaci√≥n. Por favor habilita la geolocalizaci√≥n.");
    });
}

function toggleModo() {
    const body = document.body;
    modoOscuro = !modoOscuro;

    if(body.classList.contains('fondo')) {
        body.classList.remove('fondo');
        body.classList.add('fondo-oscuro');
    } else {
        body.classList.remove('fondo-oscuro');
        body.classList.add('fondo');
    }
}
</script>
</body>
</html>
